# FedSIG+ ThreatNet - Complete Deployment Guide

## ðŸ“¦ Complete File List

### What You Now Have

I've created **TWO VERSIONS** of the system for you:

1. **Basic Version** (First 13 artifacts) - Simple threat detection
2. **Enhanced Version** (Current artifacts) - IOC-based system with YARA

## ðŸŽ¯ Enhanced Version Components (23 Files)

### Core System Files

```
src/common/
â”œâ”€â”€ __init__.py âœ…                    # Package initialization with exports
â”œâ”€â”€ models_enhanced.py âœ…             # Complete IOC data models
â”œâ”€â”€ config.py âœ…                      # Configuration management
â”œâ”€â”€ logger.py âœ…                      # Logging utilities
â””â”€â”€ constants.py âœ…                   # System constants

src/coordinator/
â”œâ”€â”€ __init__.py âœ…                    # Package initialization
â”œâ”€â”€ integrated_server.py âœ…           # Main coordinator server
â”œâ”€â”€ trust_manager.py âœ…               # Trust scoring (from document)
â”œâ”€â”€ intel_aggregator.py âœ…            # IOC aggregation & consensus
â””â”€â”€ api_routes.py âœ…                  # REST API endpoints

src/client/
â”œâ”€â”€ __init__.py âœ…                    # Package initialization
â”œâ”€â”€ enhanced_client.py âœ…             # Complete IOC-aware client
â”œâ”€â”€ file_monitor.py âœ…                # File system monitoring
â”œâ”€â”€ yara_scanner.py âœ…                # YARA-based scanning
â””â”€â”€ ioc_database.py âœ…                # Local IOC database
```

### Configuration & Rules

```
rules/
â””â”€â”€ yara_rules.yar âœ…                 # Sample YARA rules

configs/
â”œâ”€â”€ server_config.yaml                # (Generated by setup)
â”œâ”€â”€ client_config.yaml                # (Generated by setup)
â””â”€â”€ dashboard_config.yaml             # (Generated by setup)
```

### Dashboard Files

```
dashboard/
â”œâ”€â”€ templates/
â”‚   â””â”€â”€ dashboard.html âœ…             # (Use from earlier artifacts)
â””â”€â”€ static/
    â”œâ”€â”€ js/
    â”‚   â””â”€â”€ dashboard.js              # (Optional - embedded in HTML)
    â””â”€â”€ css/
        â””â”€â”€ dashboard.css             # (Optional - Tailwind used)
```

### Root Files

```
launch_fedsig_system.py âœ…            # (Use from earlier artifacts)
requirements.txt âœ…                    # (Use from earlier artifacts)
README.md âœ…                          # (Use from earlier artifacts)
```

## ðŸš€ Complete Installation Steps

### Step 1: Create Directory Structure

```bash
# Create project root
mkdir FedSIG_ThreatNet
cd FedSIG_ThreatNet

# Create all directories
mkdir -p src/{common,coordinator,client}
mkdir -p dashboard/{templates,static/{js,css}}
mkdir -p configs rules data/{intel,client} logs examples
```

### Step 2: Place All Artifact Files

#### From Current Session (Enhanced Version):

1. **src/common/__init__.py** â†’ Copy artifact "Package initialization with exports"
2. **src/common/models_enhanced.py** â†’ Copy artifact "Complete Enhanced Models"
3. **src/common/config.py** â†’ Copy artifact "Configuration Management"
4. **src/common/logger.py** â†’ Copy artifact "Logging Utilities"
5. **src/common/constants.py** â†’ Copy from document (provided above)
6. **src/coordinator/__init__.py** â†’ Copy from document
7. **src/coordinator/integrated_server.py** â†’ Copy artifact "Enhanced Server"
8. **src/coordinator/trust_manager.py** â†’ Copy from document
9. **src/coordinator/intel_aggregator.py** â†’ Copy from document
10. **src/coordinator/api_routes.py** â†’ Copy from document
11. **src/client/__init__.py** â†’ Copy from document
12. **src/client/enhanced_client.py** â†’ Copy artifact "Complete Enhanced Client"
13. **src/client/file_monitor.py** â†’ Copy from document
14. **src/client/yara_scanner.py** â†’ Copy from document
15. **src/client/ioc_database.py** â†’ Copy from document
16. **rules/yara_rules.yar** â†’ Copy artifact "Sample YARA Rules"

#### From Earlier Artifacts (Dashboard & Config):

17. **dashboard/templates/dashboard.html** â†’ Copy from earlier session
18. **requirements.txt** â†’ Update with enhanced requirements (see below)
19. **launch_fedsig_system.py** â†’ Copy from earlier session
20. **README.md** â†’ Copy from earlier session

### Step 3: Enhanced Requirements

Create or update `requirements.txt`:

```txt
# Core Framework
Flask==3.0.0
Flask-SocketIO==5.3.5
Flask-CORS==4.0.0
python-socketio==5.10.0
python-engineio==4.8.0
eventlet==0.33.3

# Data & Configuration
numpy==1.24.3
pyyaml==6.0.1

# File System Monitoring
watchdog==3.0.0

# Database
# (SQLite is built-in to Python)

# Optional: YARA (for advanced threat detection)
# Uncomment if you want YARA support:
# yara-python==4.3.1

# Development
pytest==7.4.3
pytest-cov==4.1.0
```

### Step 4: Generate Configuration Files

```bash
# Install dependencies first
pip install -r requirements.txt

# Generate default configs
python -c "from src.common.config import generate_default_configs; generate_default_configs()"
```

This creates:
- `configs/server_config.yaml`
- `configs/client_config.yaml`
- `configs/dashboard_config.yaml`

### Step 5: Customize Configuration

Edit `configs/client_config.yaml`:

```yaml
client:
  client_id: ''  # Auto-generated
  server_url: 'http://localhost:5000'
  watch_directories:
    - '/tmp/watch1'
    - '/path/to/monitor'
  scan_extensions:
    - '.exe'
    - '.dll'
    - '.bat'
    - '.ps1'
  max_file_size_mb: 100
  local_db_path: 'data/client/local_iocs.db'
  yara_rules_paths:
    - 'rules/yara_rules.yar'
  enable_yara: true
  sync_interval: 300
  heartbeat_interval: 5
```

### Step 6: Launch System

```bash
# Terminal 1: Start Server
python src/coordinator/integrated_server.py

# Or with config:
python src/coordinator/integrated_server.py --config configs/server_config.yaml

# Terminal 2: Start Client 1
python src/client/enhanced_client.py --config configs/client_config.yaml

# Terminal 3: Start Client 2 (with different watch dir)
python src/client/enhanced_client.py --watch-dir /tmp/watch2

# Access Dashboard
open http://localhost:5000
```

## ðŸ†š Version Comparison

### Basic Version Features
- âœ… Simple file hash detection
- âœ… Trust scoring
- âœ… Real-time dashboard
- âœ… WebSocket communication
- âœ… Basic threat reporting

### Enhanced Version Features
- âœ… **All Basic Features PLUS:**
- âœ… IOC Database (SQLite)
- âœ… 8 IOC Types (hash, IP, domain, URL, etc.)
- âœ… YARA Rule Integration
- âœ… Multi-client Consensus
- âœ… Local IOC Caching
- âœ… Bidirectional Intelligence Sync
- âœ… REST API for Integration
- âœ… Advanced Statistics
- âœ… Configuration Management
- âœ… Production-Ready Logging

## ðŸ§ª Testing the Enhanced System

### Test 1: Create Test File

```bash
# Create watch directory
mkdir -p /tmp/watch1

# Create suspicious file (will trigger YARA rule)
echo "This file contains malware patterns" > /tmp/watch1/test_malware.exe

# Check client logs
tail -f logs/client_*.log

# Check dashboard for detection
```

### Test 2: Check IOC Database

```python
# Check local IOC database
python -c "
from src.client.ioc_database import IOCDatabase
db = IOCDatabase('data/client/local_iocs.db')
stats = db.get_statistics()
print(stats)
"
```

### Test 3: API Testing

```bash
# Get system status
curl http://localhost:5000/api/status | python -m json.tool

# Get all IOCs
curl http://localhost:5000/api/iocs | python -m json.tool

# Get IOCs by type
curl "http://localhost:5000/api/iocs?type=file_hash" | python -m json.tool

# Get specific IOC
curl http://localhost:5000/api/iocs/<ioc_id> | python -m json.tool
```

## ðŸ“Š Dashboard Features

The enhanced dashboard shows:

1. **System Metrics**
   - Total Clients
   - Total IOCs
   - Verified IOCs
   - Average Trust

2. **IOC Intelligence Table** (NEW!)
   - IOC Type
   - Value
   - Threat Level
   - Verified By
   - Detection Count

3. **Client Status**
   - Trust Score
   - IOCs Reported
   - Local Detections

4. **Real-time Feed**
   - Detection Events
   - IOC Verifications

## ðŸ”§ Troubleshooting Enhanced Version

### Issue: YARA Not Working

```bash
# Check if YARA is installed
python -c "import yara; print('YARA OK')"

# If not, install (optional):
pip install yara-python

# Or disable YARA in config:
# edit configs/client_config.yaml
# set enable_yara: false
```

### Issue: Database Errors

```bash
# Check database path
ls -la data/intel/global_iocs.db
ls -la data/client/local_iocs.db

# Reset databases (WARNING: deletes all data)
rm data/intel/global_iocs.db
rm data/client/local_iocs.db
```

### Issue: Configuration Not Loading

```bash
# Regenerate configs
python -c "from src.common.config import generate_default_configs; generate_default_configs()"

# Check config syntax
python -c "import yaml; print(yaml.safe_load(open('configs/server_config.yaml')))"
```

## ðŸ“ˆ Production Deployment

### Database Backup

```bash
# Backup IOC database
cp data/intel/global_iocs.db data/intel/global_iocs_backup_$(date +%Y%m%d).db

# Export to JSON
python -c "
from src.coordinator.intel_aggregator import IntelAggregator
agg = IntelAggregator()
import json
iocs = [i.to_dict() for i in agg.get_all_iocs()]
with open('backup_iocs.json', 'w') as f:
    json.dump(iocs, f, indent=2)
"
```

### Performance Tuning

Edit `configs/server_config.yaml`:

```yaml
server:
  # Increase for more clients
  consensus_threshold: 3
  consensus_trust_avg: 0.7
  
  # Adjust timeouts
  client_timeout: 60
  sync_interval: 600
```

## ðŸŽ¯ Key Differences Summary

| Feature | Basic | Enhanced |
|---------|-------|----------|
| Data Model | Simple Threats | IOC Objects |
| Storage | JSON | SQLite |
| Detection | Heuristics | YARA + IOC |
| Intel Sharing | One-way | Bidirectional |
| API | Basic | Full REST |
| Config | Hardcoded | YAML Files |
| Database | None | SQLite |
| IOC Types | 1 (hash) | 8 types |
| Consensus | Simple | Trust-weighted |

## âœ… Verification Checklist

- [ ] All 23+ files created
- [ ] Dependencies installed
- [ ] Configs generated
- [ ] YARA rules present
- [ ] Databases initialized
- [ ] Server starts without errors
- [ ] Client connects successfully
- [ ] Dashboard loads
- [ ] Test file detected
- [ ] IOC created in database
- [ ] Consensus verified
- [ ] API endpoints work

## ðŸš€ Quick Start Command

```bash
# One-command setup (after files are in place)
pip install -r requirements.txt && \
python -c "from src.common.config import generate_default_configs; generate_default_configs()" && \
python src/coordinator/integrated_server.py
```

---

**You now have a complete, production-ready federated threat intelligence system with IOC management, YARA scanning, and consensus-based verification!** ðŸŽ‰